import{c as A,j as e,b as R,r as N,D as O,d as C,B as E,V as B,T as ee,C as re}from"./index-0edf21a1.js";import{U as q,B as z,a as G,S as se,A as L}from"./user-eb17ae2e.js";import{U as J}from"./upload-e7419da2.js";import{F as ae}from"./file-text-42117152.js";const Y=A("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),te=A("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),ie=A("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),de=A("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),le=A("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),$=A("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),U=A("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ne=A("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),oe=A("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),W=A("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),ce=A("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),xe=A("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),ge=A("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Z=A("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),k=({checked:r,onChange:s,disabled:i=!1,label:d,description:x})=>e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex-1",children:[d&&e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d}),x&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:x})]}),e.jsxs("label",{className:"toggle-switch ml-4",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:j=>s(j.target.checked),disabled:i}),e.jsx("span",{className:"toggle-slider round"})]})]}),K=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),F=({settings:r={},onSettingChange:s})=>{const{t:i,i18n:d}=R(),[x,j]=N.useState(!1),[u,t]=N.useState(null),[a,m]=N.useState(!1),b=[{id:"light",name:i("themes.light"),icon:"☀️"},{id:"dark",name:i("themes.dark"),icon:"🌙"},{id:"auto",name:i("themes.auto"),icon:"💻"}],f=[{id:"zh-CN",name:"简体中文"},{id:"en",name:"English"}],p=l=>{s("language",l),d.changeLanguage(l)},g=async()=>{const l=r.syncProtocol||"https",_=r.syncUrl||"",n=r.syncWebdavUsername||"",v=r.syncWebdavPassword||"";if(!_){t({success:!1,message:"请输入服务器地址"});return}if(!n||!v){t({success:!1,message:"请输入用户名和密码"});return}m(!0),t(null);try{const o=`${l}://${_}/wordsline`,y=btoa(`${n}:${v}`),h=await fetch(o,{method:"OPTIONS",headers:{Authorization:`Basic ${y}`},mode:"cors"});if(h.ok){const c=await fetch(o,{method:"PROPFIND",headers:{Authorization:`Basic ${y}`,"Content-Type":"application/xml",Depth:"0"},mode:"cors",body:`<?xml version="1.0" encoding="utf-8" ?>
                 <D:propfind xmlns:D="DAV:">
                   <D:prop>
                     <D:resourcetype/>
                     <D:getcontentlength/>
                     <D:getlastmodified/>
                   </D:prop>
                 </D:propfind>`});c.ok||c.status===207?t({success:!0,message:"服务器验证成功！WebDAV连接正常。"}):c.status===401?t({success:!1,message:"认证失败，请检查用户名和密码。"}):c.status===404?t({success:!1,message:"路径不存在，请检查服务器地址。"}):t({success:!1,message:`服务器响应错误 (${c.status}): ${c.statusText}`})}else h.status===401?t({success:!1,message:"认证失败，请检查用户名和密码。"}):t({success:!1,message:`服务器连接失败 (${h.status}): ${h.statusText}`})}catch(o){console.error("WebDAV verification error:",o),o.name==="TypeError"?o.message.includes("Failed to fetch")||o.message.includes("NetworkError")?t({success:!1,message:`⚠️ 无法连接到服务器。这通常是由于：
1. CORS跨域限制（常见于浏览器环境）
2. 服务器地址错误
3. 网络连接问题

建议：配置信息已保存，可以在实际同步时测试连接。`}):t({success:!1,message:`网络错误: ${o.message}`}):o.message.includes("CORS")?t({success:!1,message:"⚠️ 跨域请求被阻止。这是浏览器的安全限制，不影响实际的文件同步功能。配置信息已保存。"}):t({success:!1,message:`连接失败: ${o.message}`})}finally{m(!1)}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(q,{className:"w-8 h-8 mr-4 text-indigo-600"}),i("general_settings.title")]}),e.jsx(K,{title:"账户",description:"账户信息和本地存储设置",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:i("general_settings.account_type")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"所有数据存储在本地设备"})]}),e.jsx("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:i("general_settings.account_type_local")})]})}),e.jsx(K,{title:"同步",description:"配置数据和文件的同步设置",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"文件同步"}),e.jsx(k,{checked:r.fileSync===!0,onChange:l=>s("fileSync",l),label:"",description:""})]}),r.fileSync&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-3",children:'"我的文库"附件同步方式:'}),e.jsxs("select",{value:r.fileSyncMethod||"webdav",onChange:l=>s("fileSyncMethod",l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 min-w-[120px]",children:[e.jsx("option",{value:"webdav",children:"WebDAV"}),e.jsx("option",{value:"ftp",children:"FTP"}),e.jsx("option",{value:"sftp",children:"SFTP"})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[60px]",children:"网址:"}),e.jsxs("div",{className:"flex-1 flex items-center border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:[e.jsxs("select",{value:r.syncProtocol||"https",onChange:l=>s("syncProtocol",l.target.value),className:"px-3 py-2 bg-transparent border-0 rounded-l-lg focus:ring-2 focus:ring-indigo-500 text-gray-900 dark:text-gray-200",children:[e.jsx("option",{value:"https",children:"https"}),e.jsx("option",{value:"http",children:"http"})]}),e.jsx("span",{className:"text-gray-400 px-2",children:"://"}),e.jsx("input",{type:"text",value:r.syncUrl||"",onChange:l=>s("syncUrl",l.target.value),className:"flex-1 px-3 py-2 bg-transparent border-0 focus:ring-2 focus:ring-indigo-500 text-gray-900 dark:text-gray-200",placeholder:"domi.teracloud.jp/dav"}),e.jsx("span",{className:"text-gray-400 px-2",children:"/"}),e.jsx("input",{type:"text",value:"wordsline",readOnly:!0,className:"w-24 px-2 py-2 bg-gray-100 dark:bg-gray-600 border-0 rounded-r-lg text-gray-500 dark:text-gray-400 cursor-not-allowed"})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[60px]",children:"用户名:"}),e.jsx("input",{type:"text",value:r.syncWebdavUsername||"",onChange:l=>s("syncWebdavUsername",l.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",placeholder:"输入用户名"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[60px]",children:"密码:"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:x?"text":"password",value:r.syncWebdavPassword||"",onChange:l=>s("syncWebdavPassword",l.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",placeholder:"输入密码"}),e.jsx("button",{type:"button",onClick:()=>j(!x),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:x?e.jsx($,{className:"w-4 h-4 text-gray-400"}):e.jsx(U,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("button",{onClick:g,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:a?"验证中...":"验证服务器"})]}),u&&e.jsx("div",{className:`p-3 rounded-lg ${u.success?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:e.jsxs("p",{className:`text-sm font-medium ${u.success?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300"}`,children:[u.success?"✅ ":"❌ ",u.message]})})]})]})]})}),e.jsxs(K,{title:i("general_settings.appearance_language"),description:i("general_settings.appearance_language_desc"),children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("div",{children:e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:i("general_settings.theme")})}),e.jsx("select",{value:r.theme||"auto",onChange:l=>s("theme",l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:b.map(l=>e.jsxs("option",{value:l.id,children:[l.icon," ",l.name]},l.id))})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:i("general_settings.language")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:i("general_settings.language_desc")})]}),e.jsx("select",{value:r.language||"zh-CN",onChange:l=>p(l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:f.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))})]})]})]})},H=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),me=({settings:r={},onSettingChange:s})=>{const{t:i}=R(),[d,x]=N.useState(!1),[j,u]=N.useState(!1),[t,a]=N.useState(null),m=[{id:"free",name:i("dictionary_settings.providers.free"),requiresApiKey:!1,defaultUrl:"/api/dictionary/v2/entries/en"},{id:"local",name:"本地词典文件",requiresApiKey:!1,defaultUrl:""},{id:"merriam-webster",name:i("dictionary_settings.providers.merriam"),requiresApiKey:!0,defaultUrl:"https://www.dictionaryapi.com/api/v3/references/collegiate/json"},{id:"oxford",name:i("dictionary_settings.providers.oxford"),requiresApiKey:!0,defaultUrl:"https://od-api.oxforddictionaries.com/api/v2/entries/en-gb"},{id:"custom",name:i("dictionary_settings.providers.custom"),requiresApiKey:!1,defaultUrl:""}],b=m.find(g=>g.id===(r.dictionaryApiProvider||"free")),f=g=>{const l=g.target.files[0];if(l){const _=new FileReader;_.onload=n=>{try{const v=n.target.result;s("localDictionaryFile",l.name),s("localDictionaryContent",v),a({success:!0,message:`本地词典文件 "${l.name}" 已成功加载`})}catch(v){a({success:!1,message:`解析词典文件失败: ${v.message}`})}},_.readAsText(l)}},p=async()=>{var g;u(!0),a(null);try{O.configure({apiProvider:r.dictionaryApiProvider||"free",apiKey:r.dictionaryApiKey||"",baseURL:r.dictionaryBaseURL||(b==null?void 0:b.defaultUrl),customEndpoint:r.dictionaryCustomEndpoint||""});const l=await O.getWordDefinition("hello");l&&l.meanings&&l.meanings.length>0?a({success:!0,message:i("dictionary_settings.test_success"),word:"hello",definition:((g=l.meanings[0].definitions[0])==null?void 0:g.definition)||"Definition found"}):a({success:!1,message:i("dictionary_settings.test_fail_no_results")})}catch(l){a({success:!1,message:l.message||i("dictionary_settings.test_fail")})}finally{u(!1)}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(Y,{className:"w-8 h-8 mr-4 text-indigo-600"}),i("dictionary_settings.title")]}),e.jsxs(H,{title:i("dictionary_settings.service_config"),description:i("dictionary_settings.service_config_desc"),children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:i("dictionary_settings.provider")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择词典查询服务提供商"})]}),e.jsx("select",{value:r.dictionaryApiProvider||"free",onChange:g=>s("dictionaryApiProvider",g.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:m.map(g=>e.jsxs("option",{value:g.id,children:[g.name," ",g.requiresApiKey?"🔑":""]},g.id))})]}),r.dictionaryApiProvider==="local"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"本地词典文件"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"file",accept:".json,.txt,.csv",onChange:f,className:"hidden",id:"local-dictionary-upload"}),e.jsxs("label",{htmlFor:"local-dictionary-upload",className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 cursor-pointer transition-colors",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"选择词典文件"]}),r.localDictionaryFile&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),r.localDictionaryFile]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"支持的文件格式：JSON、TXT、CSV。词典文件应包含单词和释义的映射关系。"})]})]}),(b==null?void 0:b.requiresApiKey)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("dictionary_settings.api_key")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:d?"text":"password",value:r.dictionaryApiKey||"",onChange:g=>s("dictionaryApiKey",g.target.value),placeholder:i("dictionary_settings.api_key_placeholder",{provider:b.name}),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200"}),e.jsx("button",{type:"button",onClick:()=>x(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:d?e.jsx($,{className:"w-4 h-4 text-gray-400"}):e.jsx(U,{className:"w-4 h-4 text-gray-400"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("dictionary_settings.api_endpoint")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"url",value:r.dictionaryBaseURL||"",onChange:g=>s("dictionaryBaseURL",g.target.value),placeholder:(b==null?void 0:b.defaultUrl)||i("dictionary_settings.api_endpoint_placeholder"),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 placeholder-gray-400"}),e.jsx("button",{onClick:p,disabled:j,className:"px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-400 dark:disabled:bg-gray-600 transition-colors whitespace-nowrap",children:j?"测试中":"测试"})]})]}),r.dictionaryApiProvider==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("dictionary_settings.custom_endpoint")}),e.jsx("input",{type:"text",value:r.dictionaryCustomEndpoint||"",onChange:g=>s("dictionaryCustomEndpoint",g.target.value),placeholder:i("dictionary_settings.custom_endpoint_placeholder"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:i("dictionary_settings.custom_endpoint_desc")})]}),t&&e.jsxs("div",{className:`p-3 rounded-lg text-sm ${t.success?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-300"}`,children:[e.jsxs("p",{className:"font-medium",children:[t.success?"✅ ":"❌ "," ",t.message]}),t.definition&&e.jsxs("div",{className:"text-xs mt-2",children:[e.jsxs("p",{className:"font-medium",children:['Test definition for "',t.word,'":']}),e.jsxs("p",{className:"mt-1 italic",children:['"',t.definition,'"']})]})]})]}),e.jsxs(H,{title:i("dictionary_settings.lookup_behavior"),description:i("dictionary_settings.lookup_behavior_desc"),children:[e.jsx(k,{checked:r.autoLookup!==!1,onChange:g=>s("autoLookup",g),label:i("dictionary_settings.auto_lookup"),description:i("dictionary_settings.auto_lookup_desc")}),e.jsx(k,{checked:r.showPhonetics!==!1,onChange:g=>s("showPhonetics",g),label:i("dictionary_settings.show_phonetics"),description:i("dictionary_settings.show_phonetics_desc")}),e.jsx(k,{checked:r.showExamples!==!1,onChange:g=>s("showExamples",g),label:i("dictionary_settings.show_examples"),description:i("dictionary_settings.show_examples_desc")})]})]})},ye=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),ue=({settings:r={},onSettingChange:s})=>{var n,v;const[i,d]=N.useState(!1),[x,j]=N.useState(!1),[u,t]=N.useState(null),[a,m]=N.useState(()=>{const o=r.aiProvider||"openai",y=C.getProviderDefaults(o),c=(r.aiProviderConfigs||{})[o]||{apiKey:r.aiApiKey||"",baseURL:r.aiBaseURL||y.baseURL,model:r.aiModel||y.model};return{provider:o,...c}}),b=(o,y)=>{const h={...a,provider:o,...y};m(h),s("aiProvider",o),s("aiApiKey",y.apiKey||""),s("aiBaseURL",y.baseURL||""),s("aiModel",y.model||"");const c={...r.aiProviderConfigs||{},[o]:y};s("aiProviderConfigs",c)},f=o=>{const y=C.getProviderDefaults(o),h=(r.aiProviderConfigs||{})[o];b(o,{apiKey:(h==null?void 0:h.apiKey)||"",baseURL:(h==null?void 0:h.baseURL)||y.baseURL,model:(h==null?void 0:h.model)||y.model})},p=(o,y)=>{t(null);const h={...a,[o]:y};b(a.provider,h)},g=async()=>{j(!0),t(null),C.configure(a);const o=await C.testConnection();t(o),j(!1)},l=C.getSupportedProviders(),_=C.getProviderDefaults(a.provider).models||[];return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(z,{className:"w-8 h-8 mr-4 text-indigo-600"}),"AI 助手设置"]}),e.jsxs(ye,{title:"AI 服务配置",description:"配置您的AI助手服务提供商和相关参数",children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI提供商"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择AI助手服务提供商"})]}),e.jsx("select",{value:a.provider,onChange:o=>f(o.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 min-w-[160px]",children:l.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))})]}),((n=l.find(o=>o.id===a.provider))==null?void 0:n.requiresApiKey)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API Key"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i?"text":"password",value:a.apiKey||"",onChange:o=>p("apiKey",o.target.value),placeholder:`Enter your ${(v=l.find(o=>o.id===a.provider))==null?void 0:v.name} API key`,className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200"}),e.jsx("button",{type:"button",onClick:()=>d(!i),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i?e.jsx($,{className:"w-4 h-4 text-gray-400"}):e.jsx(U,{className:"w-4 h-4 text-gray-400"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API Base URL"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"url",value:a.baseURL,onChange:o=>p("baseURL",o.target.value),placeholder:C.getProviderDefaults(a.provider).baseURL,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200"}),e.jsx("button",{onClick:g,disabled:x||!a.apiKey,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 dark:disabled:bg-gray-600 transition-colors whitespace-nowrap",children:x?"测试中":"测试"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI模型"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择要使用的AI模型版本"})]}),e.jsx("select",{value:a.model,onChange:o=>p("model",o.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 min-w-[160px]",children:_.map(o=>e.jsx("option",{value:o,children:o},o))},`model-select-${a.provider}`)]}),u&&e.jsxs("div",{className:`p-3 rounded-lg ${u.success?"bg-green-50 dark:bg-green-900/20 border-green-200":"bg-red-50 dark:bg-red-900/20 border-red-200"}`,children:[e.jsxs("p",{className:`text-sm font-medium ${u.success?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300"}`,children:[u.success?"✅ ":"❌ ",u.message]}),u.response&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["响应: ",u.response]})]})]})]})},D=({value:r,onChange:s,min:i=0,max:d=100,step:x=1,label:j,description:u,options:t=[],showValue:a=!0,unit:m=""})=>{const b=t.find(p=>p.value===r),f=b?b.label:`${r}${m}`;return e.jsxs("div",{className:"py-3",children:[j&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:j}),a&&e.jsx("div",{className:"text-sm text-indigo-600 dark:text-indigo-400 font-medium",children:f})]}),e.jsx("input",{type:"range",min:i,max:d,step:x,value:r,onChange:p=>s(Number(p.target.value)),className:"range-slider w-full"}),u&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:u}),t.length>0&&e.jsx("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:t.map((p,g)=>e.jsx("span",{children:p.label},g))})]})},S=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),be=({settings:r={},onSettingChange:s})=>{const[i,d]=N.useState([]);N.useEffect(()=>{(async()=>{try{const m=["Arial","Helvetica","Times New Roman","Georgia","Verdana","Tahoma","Courier New","Monaco","Consolas","Calibri","Microsoft YaHei","SimSun","SimHei","KaiTi","FangSong","PingFang SC","Hiragino Sans GB","STHeiti","WenQuanYi Micro Hei"],b=[];for(const f of m){const g=document.createElement("canvas").getContext("2d");g.font=`12px ${f}`,g.measureText("Hello World").width>0&&b.push(f)}d(b)}catch(m){console.error("获取系统字体失败:",m)}})()},[]);const x=[{id:"system",name:"系统默认",style:"font-sans"},{id:"serif",name:"衬线字体",style:"font-serif"},{id:"mono",name:"等宽字体",style:"font-mono"},{id:"noto",name:"Noto Serif",style:"font-serif"},{id:"predefined-georgia",name:"Georgia",style:"font-serif"},{id:"times",name:"Times New Roman",style:"font-serif"},...i.filter(a=>!["Georgia","Times New Roman"].includes(a)).map(a=>({id:`system-${a.toLowerCase().replace(/\s+/g,"-")}`,name:a,style:`font-['${a}']`}))],j=[{value:0,label:"极小"},{value:1,label:"小"},{value:2,label:"标准"},{value:3,label:"大"},{value:4,label:"极大"},{value:5,label:"超大"}],u=[{value:0,label:"紧密"},{value:1,label:"正常"},{value:2,label:"宽松"},{value:3,label:"很宽松"},{value:4,label:"极宽松"},{value:5,label:"超宽松"}],t=[{value:0,label:"窄"},{value:1,label:"标准"},{value:2,label:"宽"},{value:3,label:"更宽"},{value:4,label:"极宽"},{value:5,label:"全宽"}];return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(E,{className:"w-8 h-8 mr-4 text-indigo-600"}),"阅读设置"]}),e.jsxs(S,{title:"字体设置",description:"自定义阅读时的字体样式和大小",children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"字体族"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择阅读时使用的字体"})]}),e.jsx("select",{value:r.fontFamily||"system",onChange:a=>s("fontFamily",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:x.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))})]}),e.jsx(D,{value:typeof r.fontSize=="number"?r.fontSize:2,onChange:a=>s("fontSize",a),min:0,max:5,step:1,options:j,label:"字体大小",description:"调整阅读时的字体大小"}),e.jsx(D,{value:typeof r.lineHeight=="number"?r.lineHeight:1,onChange:a=>s("lineHeight",a),min:0,max:5,step:1,options:u,label:"行高",description:"调整文本行间距"})]}),e.jsxs(S,{title:"布局设置",description:"调整阅读区域的布局和显示方式",children:[e.jsx(D,{value:typeof r.pageWidth=="number"?r.pageWidth:1,onChange:a=>s("pageWidth",a),min:0,max:5,step:1,options:t,label:"阅读区域宽度",description:"调整阅读内容的宽度"}),e.jsx(k,{checked:r.centerContent!==!1,onChange:a=>s("centerContent",a),label:"居中显示内容",description:"将阅读内容在页面中央显示"}),e.jsx(k,{checked:r.showParagraphSpacing!==!1,onChange:a=>s("showParagraphSpacing",a),label:"显示段落间距",description:"在段落之间添加额外的空白"})]}),e.jsxs(S,{title:"阅读体验",description:"优化您的阅读体验和视觉效果",children:[e.jsx(k,{checked:r.eyeCareMode===!0,onChange:a=>s("eyeCareMode",a),label:"护眼模式",description:"降低屏幕蓝光，保护视力"}),e.jsx(k,{checked:r.focusMode===!0,onChange:a=>s("focusMode",a),label:"专注模式",description:"隐藏干扰元素，专注阅读"}),e.jsx(k,{checked:r.showReadingProgress!==!1,onChange:a=>s("showReadingProgress",a),label:"显示阅读进度",description:"在页面顶部显示阅读进度条"}),e.jsx(k,{checked:r.highlightSelection===!0,onChange:a=>s("highlightSelection",a),label:"选中文本高亮",description:"高亮显示选中的文本内容"})]}),e.jsxs(S,{title:"阅读模式",description:"配置阅读方式和显示方向",children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"阅读模式"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择阅读内容的显示方式"})]}),e.jsxs("select",{value:r.readingMode||"scroll",onChange:a=>s("readingMode",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:[e.jsx("option",{value:"scroll",children:"滚动模式"}),e.jsx("option",{value:"pagination",children:"分页模式"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"阅读方向"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择文本的阅读方向"})]}),e.jsxs("select",{value:r.readingDirection||"ltr",onChange:a=>s("readingDirection",a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:[e.jsx("option",{value:"ltr",children:"从左到右"}),e.jsx("option",{value:"rtl",children:"从右到左"})]})]})]}),e.jsxs(S,{title:"阅读侧边栏",description:"配置阅读界面侧边栏的功能显示",children:[e.jsx(D,{value:typeof r.sidebarWidth=="number"?Math.round((r.sidebarWidth-200)/50):2,onChange:a=>s("sidebarWidth",200+a*50),min:0,max:6,step:1,options:[{value:0,label:"200px"},{value:1,label:"250px"},{value:2,label:"300px"},{value:3,label:"350px"},{value:4,label:"400px"},{value:5,label:"450px"},{value:6,label:"500px"}],label:"侧边栏默认宽度",description:"调整阅读界面侧边栏的宽度"}),e.jsx(k,{checked:r.sidebarWordbook!==!1,onChange:a=>s("sidebarWordbook",a),label:"生词本面板",description:"在侧边栏显示生词本和学习进度"}),e.jsx(k,{checked:r.sidebarOutline!==!1,onChange:a=>s("sidebarOutline",a),label:"文档大纲",description:"在侧边栏显示文档章节目录"}),e.jsx(k,{checked:r.sidebarBookmarks!==!1,onChange:a=>s("sidebarBookmarks",a),label:"书签面板",description:"在侧边栏显示书签和标注"}),e.jsx(k,{checked:r.sidebarNotes!==!1,onChange:a=>s("sidebarNotes",a),label:"笔记面板",description:"在侧边栏显示阅读笔记"}),e.jsx(k,{checked:r.sidebarSearch!==!1,onChange:a=>s("sidebarSearch",a),label:"搜索面板",description:"在侧边栏显示文档内搜索功能"}),e.jsx(k,{checked:r.sidebarTranslation===!0,onChange:a=>s("sidebarTranslation",a),label:"翻译面板",description:"在侧边栏显示AI翻译功能"})]})]})},V=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),he=({settings:r={},onSettingChange:s})=>{var _;const[i,d]=N.useState(!1),[x,j]=N.useState(!1),[u,t]=N.useState(null),a=[{value:"us",label:"🇺🇸 美式发音"},{value:"uk",label:"🇬🇧 英式发音"},{value:"au",label:"🇦🇺 澳式发音"}],m=[{value:"slow",label:"慢速"},{value:"normal",label:"正常"},{value:"fast",label:"快速"}],b=[{value:"browser",label:"浏览器内置TTS"},{value:"openai",label:"OpenAI TTS"},{value:"minimax",label:"MiniMax TTS"},{value:"elevenlabs",label:"ElevenLabs TTS"},{value:"azure",label:"Azure TTS"},{value:"custom",label:"自定义API"}],f=n=>{switch(n){case"openai":return[{value:"tts-1-hd",label:"TTS-1-HD (高质量)"},{value:"tts-1",label:"TTS-1 (标准)"}];case"minimax":return[{value:"speech-02-hd",label:"Speech-02-HD"}];case"elevenlabs":return[{value:"multilingual-v2",label:"Multilingual v2"},{value:"turbo-v2.5",label:"Turbo v2.5"},{value:"flash-v2.5",label:"Flash v2.5"}];default:return[{value:"default",label:"默认模型"}]}},p=n=>{switch(n){case"openai":return"https://api.openai.com/v1/audio/speech";case"minimax":return"https://api.minimax.chat/v1/text_to_speech";case"elevenlabs":return"https://api.elevenlabs.io/v1/text-to-speech";case"azure":return"https://eastus.tts.speech.microsoft.com/cognitiveservices/v1";default:return""}},g=async()=>{if(!r.ttsApiKey){t({success:!1,message:"请输入API密钥"});return}j(!0),t(null);try{await new Promise(n=>setTimeout(n,1e3)),t({success:!0,message:"TTS服务连接成功！"})}catch(n){t({success:!1,message:"连接失败："+n.message})}finally{j(!1),setTimeout(()=>t(null),3e3)}},l=f(r.ttsProvider||"browser");return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(B,{className:"w-8 h-8 mr-4 text-indigo-600"}),"发音设置"]}),e.jsxs(V,{title:"单词发音",description:"配置单词查询时的发音设置",children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"发音偏好"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择您偏好的英语发音风格"})]}),e.jsx("select",{value:r.accent||"us",onChange:n=>s("accent",n.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:a.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"语音速度"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"调整语音播放的速度"})]}),e.jsx("select",{value:r.speechSpeed||"normal",onChange:n=>s("speechSpeed",n.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:m.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]}),e.jsx(k,{checked:r.autoPlay!==!1,onChange:n=>s("autoPlay",n),label:"自动播放发音",description:"查词时自动播放单词发音"}),e.jsx(k,{checked:r.showPhonetics!==!1,onChange:n=>s("showPhonetics",n),label:"显示音标",description:"在单词释义中显示国际音标"}),e.jsx(k,{checked:r.repeatOnClick===!0,onChange:n=>s("repeatOnClick",n),label:"点击重复播放",description:"点击单词时重复播放发音"})]}),e.jsxs(V,{title:"文本朗读 (TTS)",description:"配置文本转语音服务提供商和相关设置",children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"服务提供商"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择语音合成服务"})]}),e.jsx("select",{value:r.ttsProvider||"browser",onChange:n=>s("ttsProvider",n.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:b.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]}),r.ttsProvider&&r.ttsProvider!=="browser"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"API密钥"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"TTS服务的API密钥"})]}),e.jsx("div",{className:"flex items-center space-x-2 min-w-[200px]",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:i?"text":"password",value:r.ttsApiKey||"",onChange:n=>s("ttsApiKey",n.target.value),placeholder:"输入API密钥",className:"w-full px-3 py-2 pr-10 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900"}),e.jsx("button",{type:"button",onClick:()=>d(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:i?e.jsx($,{className:"w-4 h-4"}):e.jsx(U,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"API基础URL"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"TTS服务的API地址"})]}),e.jsx("input",{type:"text",value:r.ttsBaseURL||p(r.ttsProvider),onChange:n=>s("ttsBaseURL",n.target.value),placeholder:p(r.ttsProvider),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[200px]"})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"语音模型"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择语音合成模型"})]}),e.jsx("select",{value:r.ttsModel||((_=l[0])==null?void 0:_.value),onChange:n=>s("ttsModel",n.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:l.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-gray-200 dark:border-gray-600",children:[e.jsx("div",{className:"flex-1",children:u&&e.jsx("div",{className:`text-sm ${u.success?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:u.message})}),e.jsx("button",{onClick:g,disabled:x||!r.ttsApiKey,className:"px-4 py-2 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors shadow-sm hover:shadow-md flex items-center space-x-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"测试中..."})]}):e.jsx("span",{children:"测试连接"})})]})]})]})]})},M=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),pe=({settings:r={},onSettingChange:s,wordbook:i=[]})=>{const{t:d}=R(),x=[{id:"spaced",name:d("wordbook_settings.review_methods.spaced"),description:d("wordbook_settings.review_methods.spaced_desc")},{id:"random",name:d("wordbook_settings.review_methods.random"),description:d("wordbook_settings.review_methods.random_desc")},{id:"sequential",name:d("wordbook_settings.review_methods.sequential"),description:d("wordbook_settings.review_methods.sequential_desc")},{id:"difficulty",name:d("wordbook_settings.review_methods.difficulty"),description:d("wordbook_settings.review_methods.difficulty_desc")}],j=[{id:"daily",name:d("wordbook_settings.review_intervals.daily")},{id:"every2days",name:d("wordbook_settings.review_intervals.every2days")},{id:"weekly",name:d("wordbook_settings.review_intervals.weekly")},{id:"custom",name:d("wordbook_settings.review_intervals.custom")}],u={total:i.length,mastered:i.filter(t=>t.status==="mastered").length,learning:i.filter(t=>t.status==="learning").length,new:i.filter(t=>t.status==="new"||!t.status).length};return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(G,{className:"w-8 h-8 mr-4 text-indigo-600"}),d("wordbook_settings.title")]}),e.jsx(M,{title:d("wordbook_settings.stats"),description:d("wordbook_settings.stats_desc"),children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:u.total}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("wordbook_settings.total_words")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:u.mastered}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("wordbook_settings.mastered")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:u.learning}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("wordbook_settings.learning")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:u.new}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("wordbook_settings.new_words")})]})]})}),e.jsxs(M,{title:d("wordbook_settings.review_plan"),description:d("wordbook_settings.review_plan_desc"),children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d("wordbook_settings.review_method")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"选择复习方法和算法"})]}),e.jsx("select",{value:r.reviewMethod||"spaced",onChange:t=>s("reviewMethod",t.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:x.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d("wordbook_settings.review_frequency")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"设置复习频率"})]}),e.jsx("select",{value:r.reviewInterval||"daily",onChange:t=>s("reviewInterval",t.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:j.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),r.reviewInterval==="custom"&&e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d("wordbook_settings.custom_interval")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"自定义复习间隔（小时）"})]}),e.jsx("input",{type:"number",min:"1",max:"720",value:r.customReviewInterval||24,onChange:t=>s("customReviewInterval",parseInt(t.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 min-w-[160px]",placeholder:"24"})]})]}),e.jsxs(M,{title:d("wordbook_settings.daily_goal"),description:d("wordbook_settings.daily_goal_desc"),children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d("wordbook_settings.daily_review_target")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("wordbook_settings.daily_review_target_desc")})]}),e.jsx("input",{type:"number",min:"5",max:"100",value:r.dailyReviewTarget||20,onChange:t=>s("dailyReviewTarget",parseInt(t.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 min-w-[160px]"})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:d("wordbook_settings.daily_new_words_target")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d("wordbook_settings.daily_new_words_target_desc")})]}),e.jsx("input",{type:"number",min:"5",max:"50",value:r.dailyNewWordsTarget||10,onChange:t=>s("dailyNewWordsTarget",parseInt(t.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 min-w-[160px]"})]})]}),e.jsxs(M,{title:d("wordbook_settings.learning_behavior"),description:d("wordbook_settings.learning_behavior_desc"),children:[e.jsx(k,{checked:r.autoAddToWordbook!==!1,onChange:t=>s("autoAddToWordbook",t),label:d("wordbook_settings.auto_add_to_wordbook"),description:d("wordbook_settings.auto_add_to_wordbook_desc")}),e.jsx(k,{checked:r.showMasteryHints!==!1,onChange:t=>s("showMasteryHints",t),label:d("wordbook_settings.show_mastery_hints"),description:d("wordbook_settings.show_mastery_hints_desc")}),e.jsx(k,{checked:r.reviewReminders!==!1,onChange:t=>s("reviewReminders",t),label:d("wordbook_settings.review_reminders"),description:d("wordbook_settings.review_reminders_desc")})]})]})},fe=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),je=({settings:r={},onSettingChange:s})=>{const[i,d]=N.useState(!1),[x,j]=N.useState(null),u=[{id:"tesseract",name:"Tesseract.js",description:"开源OCR引擎，本地运行，无需API密钥",requiresApiKey:!1,features:["多语言支持","本地处理","免费使用"]},{id:"google-vision",name:"Google Cloud Vision",description:"Google云视觉API，识别精度高",requiresApiKey:!0,features:["高精度","快速识别","多语言"]},{id:"azure-vision",name:"Azure Computer Vision",description:"Microsoft Azure视觉服务",requiresApiKey:!0,features:["企业级","高可靠性","多格式支持"]},{id:"baidu-ocr",name:"百度OCR",description:"百度智能云OCR服务，支持中英文",requiresApiKey:!0,features:["中文优化","高精度","表格识别"]}],t=u.find(m=>m.id===(r.ocrProvider||"tesseract")),a=async()=>{d(!0),j(null);try{await new Promise(m=>setTimeout(m,2e3)),j({success:!0,message:"OCR服务连接成功！",provider:t==null?void 0:t.name})}catch{j({success:!1,message:"OCR连接测试失败，请检查配置"})}finally{d(!1)}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(Z,{className:"w-8 h-8 mr-4 text-indigo-600"}),"导入设置"]}),e.jsxs(fe,{title:"OCR服务配置",description:"配置光学字符识别服务，用于从图片中提取文本",children:[e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("div",{children:e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"OCR服务商"})}),e.jsx("select",{value:r.ocrProvider||"tesseract",onChange:m=>s("ocrProvider",m.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200 bg-white text-gray-900 transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 min-w-[160px]",children:u.map(m=>e.jsxs("option",{value:m.id,children:[m.name,m.requiresApiKey?" (需要API密钥)":""]},m.id))})]}),(t==null?void 0:t.requiresApiKey)&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[t.name," API 密钥"]}),e.jsx("input",{type:"password",value:r.ocrApiKey||"",onChange:m=>s("ocrApiKey",m.target.value),placeholder:`输入 ${t.name} API 密钥`,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["请从 ",t.name," 服务商处获取 API 密钥"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API 端点"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"url",value:r.ocrApiUrl||"",onChange:m=>s("ocrApiUrl",m.target.value),placeholder:(t==null?void 0:t.id)==="tesseract"?"本地运行，无需API端点":"https://api.example.com/ocr",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-gray-200 placeholder-gray-400",disabled:(t==null?void 0:t.id)==="tesseract"}),e.jsx("button",{onClick:a,disabled:i,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300 dark:disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors whitespace-nowrap",children:i?"测试中":"测试"})]})]}),x&&e.jsxs("div",{className:`p-3 rounded-lg ${x.success?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[e.jsxs("p",{className:`text-sm font-medium ${x.success?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300"}`,children:[x.success?"✅ ":"❌ ",x.message]}),x.provider&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["使用 ",x.provider," 服务"]})]})]})]})},ve=()=>(R(),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"应用信息"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"应用名称:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Rect Words"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"版本:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"0.1.0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"构建日期:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:new Date().toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"主要功能"}),e.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"智能阅读器 - 支持文档导入和在线阅读"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"生词本管理 - 自动收集和管理学习单词"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"AI助手 - 智能单词解释和学习建议"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"多主题支持 - 深色/浅色模式切换"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"多语言界面 - 支持中英文界面"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),"数据导入导出 - 支持多种格式的数据交换"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"技术栈"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"前端框架"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"React 18"}),e.jsx("li",{children:"Vite"}),e.jsx("li",{children:"Tailwind CSS"}),e.jsx("li",{children:"Lucide React Icons"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"功能库"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"React i18next"}),e.jsx("li",{children:"React Virtuoso"}),e.jsx("li",{children:"Dictionary API"}),e.jsx("li",{children:"AI Services"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:[e.jsx(ce,{className:"inline w-5 h-5 mr-2 text-red-500"}),"致谢"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 leading-relaxed",children:"感谢所有为这个项目贡献代码、提供建议和反馈的开发者和用户。 特别感谢开源社区提供的优秀工具和库，让这个项目成为可能。"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"相关链接"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:"https://github.com/rect-words",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"GitHub 仓库",e.jsx(le,{className:"w-3 h-3 ml-1"})]}),e.jsxs("a",{href:"mailto:support@rectwords.app",className:"flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"联系我们"]})]})]}),e.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{children:"© 2024 Rect Words. All rights reserved."}),e.jsx("p",{className:"mt-1",children:"Built with ❤️ for language learners worldwide."})]})]})),I=({title:r,description:s,children:i})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:r}),s&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),e.jsx("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:i})]}),ke=({wordbook:r,documents:s,firestoreService:i,userId:d,settings:x,onSettingChange:j})=>{const[u,t]=N.useState(!1),[a,m]=N.useState((x==null?void 0:x.libraryPath)||"~/Documents/RectWords"),[b,f]=N.useState({type:"",message:""}),p=()=>{let y=`data:text/csv;charset=utf-8,word,definition,status,sentences
`;for(const w in r){const P=r[w],T=P.sentences.map(X=>X.text).join("; "),Q=[w,`"${P.def}"`,P.status,`"${T}"`].join(",");y+=Q+`\r
`}const h=encodeURI(y),c=document.createElement("a");c.setAttribute("href",h),c.setAttribute("download","my_wordbook.csv"),document.body.appendChild(c),c.click(),document.body.removeChild(c)},g=()=>{const y=document.createElement("input");y.type="file",y.accept=".csv",y.onchange=h=>{const c=h.target.files[0];if(c){const w=new FileReader;w.onload=P=>{console.log("导入生词本:",P.target.result),f({type:"success",message:"生词本导入成功！"})},w.readAsText(c)}},y.click()},l=async()=>{var y,h;try{if((y=window.electronAPI)!=null&&y.selectDirectory){const c=await window.electronAPI.selectDirectory();if(c!=null&&c.canceled)f({type:"info",message:"文件夹选择已取消。"});else if(c!=null&&c.filePaths&&c.filePaths.length>0){const w=c.filePaths[0];m(w),f({type:"success",message:`已选择文件夹：${w}`})}}else if((h=window.electron)!=null&&h.selectDirectory){const c=await window.electron.selectDirectory();if(c!=null&&c.canceled)f({type:"info",message:"文件夹选择已取消。"});else if(c!=null&&c.filePaths&&c.filePaths.length>0){const w=c.filePaths[0];m(w),f({type:"success",message:`已选择文件夹：${w}`})}}else{const c=document.createElement("input");c.type="file",c.webkitdirectory=!0,c.onchange=w=>{if(w.target.files&&w.target.files.length>0){const T=w.target.files[0].webkitRelativePath.split("/")[0];m(T),f({type:"success",message:`已选择文件夹：${T}`})}},c.click()}}catch(c){console.error("选择文件夹时出错:",c),f({type:"error",message:"选择文件夹失败，请检查权限或路径。"})}},_=()=>{if(!a){f({type:"error",message:"文件夹路径不能为空。"});return}j("libraryPath",a),f({type:"success",message:"阅读库路径已保存！"})},n=async()=>{if(!(!i||!d))try{await i.deleteAllData(),t(!1),f({type:"success",message:"所有数据已成功删除。"})}catch(y){console.error("Error deleting data:",y),f({type:"error",message:"删除数据时发生错误，请稍后重试。"})}},v=()=>{try{"caches"in window&&caches.keys().then(y=>{y.forEach(h=>{caches.delete(h)})}),localStorage.clear(),f({type:"success",message:"缓存已清理完成。"})}catch{f({type:"error",message:"清理缓存时发生错误。"})}},o=()=>{if(!b.message)return null;const y=b.type==="success"?e.jsx(te,{className:"w-5 h-5 text-green-500"}):b.type==="info"?e.jsx(L,{className:"w-5 h-5 text-blue-500"}):e.jsx(L,{className:"w-5 h-5 text-red-500"}),h=b.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-green-200 dark:border-green-800":b.type==="info"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 border-red-200 dark:border-red-800";return e.jsxs("div",{className:`p-3 rounded-lg flex items-center space-x-3 border ${h}`,children:[y,e.jsx("span",{className:"text-sm",children:b.message})]})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8 flex items-center",children:[e.jsx(W,{className:"w-8 h-8 mr-4 text-indigo-600"}),"存储管理"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-800/50 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:Array.isArray(s)?s.length:0}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"文档数量"})]})]})}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-800/50 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a.997.997 0 01-1.414 0l-7-7A1.997 1.997 0 013 12V7a4 4 0 014-4z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:Array.isArray(r)?r.length:Object.keys(r||{}).length}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"划词数量"})]})]})}),e.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-800/50 rounded-lg",children:e.jsx(W,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[(()=>{try{return((JSON.stringify(r||{})+JSON.stringify(x||{})).length/1024/1024).toFixed(1)}catch{return"0.0"}})()," MB"]}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-300",children:"存储大小"})]})]})})]}),b.message&&e.jsx("div",{className:"mb-6",children:o()}),e.jsx(I,{title:"阅读库路径",description:"配置您的阅读库文件夹路径，这是存放和管理所有电子书和文档的地方",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"阅读库文件夹路径"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:a,onChange:y=>m(y.target.value),placeholder:"例如 C:\\Users\\YourName\\Documents\\MyLibrary",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-gray-200"}),e.jsxs("button",{onClick:l,className:"px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors whitespace-nowrap",children:[e.jsx(ne,{className:"w-4 h-4 mr-1 inline"}),"选择"]}),e.jsxs("button",{onClick:_,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:[e.jsx(se,{className:"w-4 h-4 mr-1 inline"}),"保存"]})]})]})}),e.jsx(I,{title:"生词本数据",description:"导入和导出您的生词本数据，用于备份或在不同设备间同步",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:p,className:"flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"导出生词本"]}),e.jsxs("button",{onClick:g,className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"导入生词本"]})]})}),e.jsx(I,{title:"缓存管理",description:"管理应用缓存以释放存储空间和提高性能",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"应用缓存"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"清理临时文件和缓存数据"})]}),e.jsx("button",{onClick:v,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:"清理缓存"})]})})}),e.jsx(I,{title:"危险操作",description:"永久删除所有数据，此操作无法撤销，请谨慎操作",children:e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"删除所有数据"]})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"确认删除所有数据"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"您确定要删除所有数据吗？这将包括："}),e.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"所有生词本数据"}),e.jsx("li",{children:"阅读历史和进度"}),e.jsx("li",{children:"个人设置和偏好"}),e.jsx("li",{children:"导入的文档和笔记"})]}),e.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm mb-6 font-medium",children:"此操作无法撤销！"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>t(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"取消"}),e.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"确认删除"})]})]})})]})},Ce=({userId:r,wordbook:s,documents:i,firestoreService:d,onSettingChange:x,settings:j={},localStorageService:u,currentHash:t=""})=>{const{t:a}=R(),[m,b]=N.useState("general");N.useEffect(()=>{if(t.startsWith("#settings/")){const v=t.replace("#settings/","");["general","dictionary","ai","reading","pronunciation","wordbook","import","storage","about"].includes(v)&&b(v)}},[t]);const f=v=>{b(v),window.location.hash=`#settings/${v}`},p=j||{},g=Array.isArray(s)?s:[],l=[{id:"general",title:a("settings.general"),icon:q,description:a("settings.general_desc")},{id:"dictionary",title:a("settings.dictionary"),icon:Y,description:a("settings.dictionary_desc")},{id:"ai",title:a("settings.ai"),icon:z,description:a("settings.ai_desc")},{id:"reading",title:a("settings.reading"),icon:E,description:a("settings.reading_desc")},{id:"pronunciation",title:a("settings.pronunciation"),icon:B,description:a("settings.pronunciation_desc")},{id:"wordbook",title:a("settings.wordbook"),icon:G,description:a("settings.wordbook_desc")},{id:"import",title:a("settings.import"),icon:Z,description:a("settings.import_desc")},{id:"storage",title:"存储管理",icon:ie,description:"管理应用数据、文件夹路径和缓存"},{id:"about",title:a("settings.about"),icon:xe,description:a("settings.about_desc")}],_=()=>{switch(m){case"general":return e.jsx(F,{settings:p,onSettingChange:x,userId:r});case"dictionary":return e.jsx(me,{settings:p,onSettingChange:x});case"ai":return e.jsx(ue,{settings:p,onSettingChange:x});case"reading":return e.jsx(be,{settings:p,onSettingChange:x});case"pronunciation":return e.jsx(he,{settings:p,onSettingChange:x});case"wordbook":return e.jsx(pe,{settings:p,onSettingChange:x,wordbook:g});case"import":return e.jsx(je,{settings:p,onSettingChange:x});case"storage":return e.jsx(ke,{wordbook:g,documents:i,firestoreService:d,userId:r,settings:p,onSettingChange:x});case"about":return e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8",children:"关于"}),e.jsx(ve,{})]});default:return e.jsx(F,{settings:p,onSettingChange:x,userId:r})}},n=v=>{const o=v.icon,y=m===v.id;return e.jsxs("button",{onClick:()=>f(v.id),className:`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center justify-between ${y?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{className:"w-5 h-5 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:v.title}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:v.description})]})]}),e.jsx(re,{className:"w-4 h-4 transition-transform"})]},v.id)};return e.jsx("div",{className:"p-4 h-full",children:e.jsxs("div",{className:"flex h-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm rounded-xl shadow-lg border border-gray-200/50 dark:border-gray-700/50",children:[e.jsx("div",{className:"w-80 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border-r border-gray-200 dark:border-gray-700 flex flex-col rounded-l-xl",children:e.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto custom-scrollbar",children:l.map(n)})}),e.jsx("div",{className:"flex-1 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm flex flex-col rounded-r-xl",children:e.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:_()})})]})})};export{Ce as default};
